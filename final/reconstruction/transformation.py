import numpy as np
from scipy.spatial.transform import Rotation as R

T_02 = np.array([5.956621e-02, 2.900141e-04, 2.577209e-03])
T_03 = np.array([-4.731050e-01, 5.551470e-03, -5.250882e-03])

T23 = -T_02 + T_03

print('T23', T23)

R_02 = np.array([[9.999758e-01, -5.267463e-03, -4.552439e-03], 
                [5.251945e-03, 9.999804e-01, -3.413835e-03], 
                [4.570332e-03, 3.389843e-03, 9.999838e-01]])

R_03 = np.array([[9.995599e-01, 1.699522e-02, -2.431313e-02], 
                [-1.704422e-02, 9.998531e-01, -1.809756e-03], 
                [2.427880e-02, 2.223358e-03, 9.997028e-01]])

R_23 = R_02.T.dot(R_03)

print('R_23', R_23)

r = R.from_matrix(R_23)

r_euler = r.as_euler('zyx', degrees=True)
print('r_euler', r_euler)


# ground truth
# T23 [-0.53267121  0.00526146 -0.00782809]

# R_23 [[ 0.99955716  0.02225614 -0.01975307]
#  [-0.02222673  0.99975152  0.00170718]
#  [ 0.01978616 -0.00126738  0.99980347]]

# r_euler [-1.27553715 -1.13184123 -0.09783354]


# result
# R: [0.9996847321281889, 0.02333824274224507, -0.009260819374934438;
#  -0.02359096283361033, 0.9993241901599044, -0.02818917228005423;
#  0.008596675076698639, 0.02839875678538437, 0.9995597069663573]
# t: [-0.5319969138335164;
#  0.02770001715898749;
#  -0.001253187421257889]

# 0.999435    0.0223351   -0.0251338    
#   -0.0223131      0.99975   0.00115619   
#    0.0251534 -0.000594725     0.999683

# R_tmp = np.array([[0.9996847321281889, 0.02333824274224507, -0.009260819374934438],
# [-0.02359096283361033, 0.9993241901599044, -0.02818917228005423],
# [0.008596675076698639, 0.02839875678538437, 0.9995597069663573]])

# r2 = R.from_matrix(R_tmp)
# print(r2.as_euler('zyx', degrees=True))

# R_tmp2 = np.array([[0.999435,    0.0223351,   -0.0251338],    
#                 [-0.0223131,      0.99975,   0.00115619],   
#                 [0.0251534, -0.000594725,     0.999683]])

# r3 = R.from_matrix(R_tmp2)

# print(r3.as_euler('zyx', degrees=True))